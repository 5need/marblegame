package lobby

import (
	"marblegame/views"
)

templ LobbyView(lobby *Lobby, userToken string) {
	@views.RawBase("MarbleGame") {
		<div class="flex min-h-screen flex-col bg-base text-text">
			<form
				id="lobby-form"
				hx-ext="ws"
				ws-connect={ "/ws/lobby/" + lobby.Id + "?userToken=" + userToken }
				ws-send
				_="on submit set the value of #chatbox-input to '' end"
			>
				<input
					id="lobby-input"
					name="message"
					class="w-full bg-transparent text-text"
					placeholder="something..."
					_="on blur set my value to ''"
				/>
			</form>
			<div id="currentLobby"></div>
			<div>
				Players:
				for _, player := range lobby.Players {
					<div>{ player }</div>
				}
			</div>
		</div>
	}
}

templ PregameLobby(userToken string) {
	@views.RawBase("MarbleGame") {
		<div class="min-h-screen bg-base text-text">
			@ListOfLobbies(map[int]*Lobby{})
		</div>
	}
}

templ ListOfLobbies(lobbies map[int]*Lobby) {
	<form
		id="listOfLobbies"
		hx-get="/listOfLobbies"
		hx-swap="innerHTML"
	>
		for _, lobby := range lobbies {
			<div>
				<a href={ templ.SafeURL("/lobby/" + lobby.Id) }>{ lobby.Id } { lobby.Name }</a>
			</div>
		}
		<button>refresh</button>
	</form>
}

templ CurrentLobby(lobby *Lobby) {
	<div id="currentLobby" hx-swap-oob="true" class="">
		{ lobby.Id } { lobby.Name }
	</div>
}
